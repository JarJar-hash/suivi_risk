/* =========================================================
   VARIABLES GLOBALES
========================================================= */
:root {
    /* Couleurs */
   --bg-page: #f4f6f8;
   --bg-card: #ffffff;
   --bg-soft: #f1f5f9;
   --bg-soft-2: #f8fafc;
   --bg-soft-warn: #e2e8f0;
   
   --blue-main: #00265a;
   --blue-mid: #1e4fa1;
   --blue-active: #2AA1EB;
   
   --text-main: #0f172a;
   --text-soft: #475569;
   --text-header: #2c3e50;

   --ca-low: #475569;
   --ca-mid: #1e3a8a;
   --ca-high: #7f1d1d;

   --border-soft: #e5e7eb;
   
   /* Dimensions */
   --radius-sm: 6px;
   --radius-md: 10px;
   --radius-lg: 14px;
   
   --control-height: 2.2rem;
   --space-xs: 4px;
   --space-sm: 8px;
   --space-md: 16px;
   --space-lg: 24px;
   
   /* Typo */
   --fs-xs: clamp(0.7rem, 0.75vw, 0.8rem);
   --fs-sm: clamp(0.8rem, 0.85vw, 0.9rem);
   --fs-md: clamp(0.9rem, 1vw, 1.05rem);
   --fs-lg: clamp(1rem, 1.2vw, 1.15rem);
}

/* =========================================================
   GLOBAL
========================================================= */
body {
    margin: 0;
    font-family: "Segoe UI", Tahoma, Arial, sans-serif;
    background: var(--bg-page);
    color: var(--text-main);
}

/* =========================================================
   HEADER
========================================================= */
.ps-header {
    position: sticky;
    top: 0;
    z-index: 1000;

    display: flex;
    align-items: center;
    gap: var(--space-lg);

    padding: var(--space-sm) var(--space-lg);
    background: linear-gradient(90deg, #00265a, #0b3c8a, #1e4fa1);
    box-shadow: 0 4px 10px rgba(0,0,0,.25);
}

.ps-header-left img {
    height: clamp(40px, 5vw, 48px);
}

.ps-header-nav {
    display: flex;
    gap: var(--space-sm);
}

.ps-header-nav a {
    color: #fff;
    text-decoration: none;
    font-weight: 600;
    font-size: var(--fs-sm);
    padding: 0.45em 0.9em;
    border-radius: var(--radius-sm);
    transition: background .2s ease;
}

.ps-header-nav a:hover {
    background: rgba(255,255,255,.15);
}

.ps-header-nav a.active {
    background: var(--blue-active);
}

/* =========================================================
   CARDS
========================================================= */

#cardsView {
    padding: var(--space-md);
}

#cardsBack {
    margin-bottom: var(--space-md);
}

#cardsGrid {
    display: grid;
    gap: var(--space-lg);
}

.card {
   background: linear-gradient(135deg, #fff, var(--card-heat, #fff));
   border-radius: var(--radius-lg);
   border-left-width: 8px;
   border-left-style: solid;
   padding: var(--space-md);
   box-shadow: 0 6px 18px rgba(0,0,0,.08);
   transition: transform .15s, box-shadow .15s;
}

.card:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 26px rgba(0,0,0,.15);
}

.card h2 {
    margin: 0;
    font-size: var(--fs-md);
    color: var(--blue-main);
}

.card-stats {
    margin-top: var(--space-sm);
    padding: var(--space-sm);
    background: var(--bg-soft);
    border-radius: var(--radius-md);
}

.stat-main {
    font-size: var(--fs-lg);
    font-weight: 700;
}

.stat-main span {
    color: #165078;
}

.stat-row {
    font-size: var(--fs-xs);
    color: var(--text-soft);
}

.ca-bar {
    margin-top: var(--space-sm);
    height: 8px;
    background: var(--border-soft);
    border-radius: 6px;
    overflow: hidden;
}

.ca-bar-fill {
    height: 100%;
    transition: width .3s ease;
}

/* =========================================================
   TABLEAU
========================================================= */

#risksView {
    padding: var(--space-md) var(--space-lg);
}

/* ========================
   CONTROLS (TOP N)
======================== */
.risk-controls {
    font-weight: 600;
    color: var(--text-header);
    background: var(--bg-soft-warn);
    padding: var(--space-sm) var(--space-md);
    margin-bottom: var(--space-lg);
    border-radius: var(--radius-sm);
}

/* ========================
   TABLE STRUCTURE
======================== */
.risk-table {
    width: 100%;
    border-collapse: collapse;
    background: var(--bg-card);
}

.risk-table th,
.risk-table td {
    padding: 0.45em 0.75em;
    font-size: var(--fs-sm);
}

.risk-table--spaced {
    margin-top: var(--space-md);
}

/* ========================
   TABLE HEADER (ex-JS)
======================== */
.risk-table thead {
    background: linear-gradient(90deg, #00265a, #0b3c8a, #1e4fa1);
    box-shadow: inset 0 -12px 0 var(--bg-page);
}

.risk-table thead tr.risk-table-header {
    background: var(--bg-soft);
    border-bottom: 2px solid var(--border-soft);
}

.risk-table thead th {
    position: sticky;
    top: 0;
    z-index: 5;
    vertical-align: bottom;
    text-align: left;
    color: var(--text-header);
}

/* ========================
   COLUMN TITLES
======================== */
.col-title {
    font-size: var(--fs-xs);
    font-weight: 700;
    margin-bottom: var(--space-xs);
    cursor: pointer;

    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* ========================
   FILTER ZONES
======================== */
.col-filter,
.filter-numeric {
    display: flex;
    gap: var(--space-xs);
    align-items: center;
}

/* Inputs communs */
.filter-input,
.filter-op {
    height: var(--control-height);
    font-size: var(--fs-xs);
    border: 1px solid #cbd5e1;
    border-radius: var(--radius-sm);
    color: var(--text-header);
    box-sizing: border-box;
}

/* Champ principal */
.filter-input {
    padding: 0 0.6em;
    background: var(--bg-soft-2);
    width: min(12rem, 100%);
}

/* Op√©rateur */
.filter-op {
    width: 2.4rem;
    background: var(--bg-soft-warn);
    font-weight: 700;
    text-align: center;
}

/* ========================
   BODY CELLS
======================== */
.risk-table td {
    border-bottom: 1px solid var(--border-soft);
    text-align: left;
    font-variant-numeric: tabular-nums;
}

/* Ligne risque (heatmap) */
.risk-cell {
    text-align: center;
    font-weight: 700;
    color: #ffffff;
}

/* Ligne CA */

.ca-low {
    color: #475569;
}

.ca-mid {
    color: #1e3a8a;
    font-weight: 600;
}

.ca-high {
    color: #7f1d1d;
    font-weight: 700;
}

/* ========================
   ROW STATES
======================== */
.risk-table tbody tr:nth-child(even) {
    background: #f9fafb;
}

.risk-table tbody tr:hover {
    background: #e8f0fd;
}

/* =========================================================
   RESPONSIVE
========================================================= */
@media (max-width: 768px) {
    .ps-header {
        flex-direction: column;
        align-items: flex-start;
    }

    .ps-header-nav {
        flex-wrap: wrap;
    }

    .risk-table thead th {
        display: flex;
        flex-direction: column;
        align-items: stretch;
    }

    .filter-input {
        width: 100%;
    }
}
